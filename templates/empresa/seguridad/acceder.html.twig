{% extends 'empresa/base.html.twig' %}

{% block title %}Acceder empresa - EasyAdmin!{% endblock %}

{% block body %}
	<div class="container">    
		<div class="row mb-3">
			<div class="col">
				{% if error %}
        			<div>{{ error.messageKey|trans(error.messageData, 'security') }}</div>
    			{% endif %}
			</div>
		</div>
		<div class="row">
			<form action="{{ path('app_empresa_seguridad_acceder') }}" method="post">
        		<div class="col">
					<label for="ruc" class="form-label">RUC</label>
        			<input type="text" class="form-control" id="ruc" name="_ruc">

    				<label for="username" class="form-label">Usuario</label>
        			<input type="text" class="form-control" id="username" name="_username_visible" value="{{ last_username }}">

					<input type="hidden" id="_username" name="_username">

        			<label for="password" class="form-label">Contraseña</label>
        			<input type="password" class="form-control" id="password" name="_password">
				
        			{# If you want to control the URL the user is redirected to on success
        			<input type="hidden" name="_target_path" value="/account"> #}
        			<input type="hidden" name="_csrf_token" value="{{ csrf_token('authenticate') }}">
				</div>

				<div class="col d-grid gap-2">  					
  					<button class="btn btn-primary btn-lg mt-3" type="submit">Iniciar Sesión</button>
				</div>
    		</form>
		</div>
	</div>
{% endblock %}

{% block js %}
	<script>
    	const usernameInput = document.getElementById('username');
    	const rucInput = document.getElementById('ruc');
		const hiddenUsernameInput = document.getElementById('_username');

    	const handleSubmit = (event) => {
        	const username = usernameInput.value;
        	const ruc = rucInput.value;
        	hiddenUsernameInput.value = `${ruc}|${username}`;
    	};

    	const form = document.querySelector('form');
    	form.addEventListener('submit', handleSubmit);
	</script>
{% endblock %}
